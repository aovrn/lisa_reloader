-------------------------------------------------------------------------------
                    ОПИСАНИЕ
-------------------------------------------------------------------------------
Данное приложение может использоваться
 * для перезапуска стандартного шелла на магнитолах kia/hyundai и вообще
   на любых устройствах с wince.
 * Для подмены окна и перехвата сообщений.
 * Для анализа активности приложений в wince.
 * И много для чего еще, поведение полностью настраивается файлом конфигурации.

Управление:
 * Окно можно перетаскивать
 * Тройной клик -- убрать сплеш-скрин
 * Клик -- листать лог
 * Повторный тройной клик -- выйти

-------------------------------------------------------------------------------
                    ФАЙЛ КОНФИГУРАЦИИ
-------------------------------------------------------------------------------
В папке conf находятся примеры конфигов, имя конфига должно быть таким же
как имя приложения, но с расширением .cfg

Конфиг состоит: 
 * из настроек приложения 
 * секций выполнения.
   Секции выполняются последовательно. Действия внутри каждой секции неразрывны
   (кроме PostWnd с timeout большим 0). Следует иметь в виду, что между
   секциями может прийти сообщение, которое поменяет порядок выполнения.

Правила написания файла конфишурации:
 1. Имя файл настроек должно быть таким же как имя приложения, но с расширением
    .cfg
 2. Файл настроек читается построчно, пробельные символы отсекаются.
    Строки могут быть следующего типа:
 2.1. Пустая строка (содержащая только пробельные символы) -- пропускается;
 2.2. Комментарий (строка начинающаяся с ; или #) -- пропускается;
 2.3. Аргумент name=value
 2.3.1 Имя аргумента регистронезависимо, пробельные символы для name и value
       также отсекаются;
 2.3.2 Целочисленные аргументы задаются как в десятичном так и
       в шеснадцатиричном виде, например, arg = 0x10 или arg = 16;
 2.3.3 Строковые аргументы могут иметь сразу два значения: arg = val1; val2
       Например, Wnd = Window Class; Window Title
 2.3.4 При необходимости можно указать строку с крайними пробельными символами
       таким образом: Wnd = ' Window Class '; 'Window Title    '
 2.3.5 Булевские аргументы могут принимать только значения yes и no
 2.4. Секция [name]
 2.4.1 Имя секции регистронезависимо
   
-------------------------------------------------------------------------------
 1. НАСТРОЙКИ
-------------------------------------------------------------------------------
 Имя                Описание
 тип: по умолчанию
 
-------------------------------------------------------------------------------
 width              Ширина окна
 int: 420
-------------------------------------------------------------------------------
 height             Длина окна
 int: 450
-------------------------------------------------------------------------------
 splash             Путь до bmp файла, закрывает окно
 str: NULL
-------------------------------------------------------------------------------
 minimize           ShowWindow при старте запускается c SW_MINIMIZE
 bool: no 
-------------------------------------------------------------------------------
 hide               ShowWindow при старте запускается c SW_HIDE. Параметр
 bool: no           не совместим с предыдущим.
-------------------------------------------------------------------------------
 wClass             Класс окна
 str: LISA_RELOADER
-------------------------------------------------------------------------------
 wTitle             Заголовок окна
 str: Lisa Reloader
-------------------------------------------------------------------------------
 separator          Разделитель строк, имеющих несколько значений. Может быть
 str: ;             переопределен любой строкой.
                    Например, separator = sep и Arg = Value1 sep Value2
-------------------------------------------------------------------------------
 quote              Можно переопределить кавычку любой строкой.
 str: '             Например, quote = @# и Arg = @# Value1   @#
-------------------------------------------------------------------------------
 secondNoActivate   Второй экземпляр с таким же классом и заголовком
 bool: no           не активирует предыдущее окно
-------------------------------------------------------------------------------
 secondNoExit       Второй экземпляр с таким же классом и заголовком
 bool: no           не завершает работу
-------------------------------------------------------------------------------


-------------------------------------------------------------------------------
 2. СЕКЦИИ
-------------------------------------------------------------------------------
 section            Имя секции
    argument1       Не обязательный аргумент
    argument2 !     Обязательный аргумент
    argument3 ...   Аргумент может повторяться многократно 
    argument4 = 0   Аргумент со значением по умолчанию

-------------------------------------------------------------------------------
 error              Служебная секция. Нельзя использовать
-------------------------------------------------------------------------------
 ListWnd            Отобразить список всех окон
-------------------------------------------------------------------------------
 PostWnd            Отправить сообщение msg с параметрами wParam и lParam окну
    timeout = 0     или окнам wnd (смотри описание аргумента wnd), используя
    wnd ...         PostMessage.
    msg = 0x0       Если указан timeout больший нуля, то ждем завершения
    wParam = 0x0    приложения, которому отправили сообщение, полезно
    lParam = 0x0    при отправлении WM_CLOSE. 
    useSend = no    Если useSend = yes, используем SendMessage вместо
    onError         PostMessage.
                    Если onError указан, в случае ошибки функций FindWindow или
                    PostMessage переходим к указанной секции.
-------------------------------------------------------------------------------
 FindWnd            Искать окно или окна wnd.
    wnd ...         Варианты check:
    check               foreground   - GetForegroundWindow
    onError         Если onError указан и FindWindow не нашел хотя бы одно окно
                    или не пройдена проверка check переходим к указанной
                    секции.
-------------------------------------------------------------------------------
 SetWnd             Выполняем action для окна или окон wnd.
    action !        Варианты action:
    wnd ...             show         - ShowWindow, flags - второй параметр
    flags = 0x0         foreground   - SetForegroundWindow 
                        focus        - SetFocus
                    Если onError указан и FindWindow не нашел хотя бы одно окно
                    или соответствующая функция вернула ошибку, переходим к
                    указанной секции
-------------------------------------------------------------------------------
 ListProc           Отобразать список всех процессов
    proc            Если указан proc, отобразить список окон этого процесса
                    Если proc = all, отобразить все процессы с окнами
-------------------------------------------------------------------------------
 KillProc           Убить процессы, перечисленные в proc, используя
    proc ...        TerminateProcess.
    onError         Если onError указан и OpenProcess или TerminateProcess
                    вернули ошибку переходим к указанной секции
-------------------------------------------------------------------------------
 StartProc          Запустить процессы с параметрами, перечисленные в path,
    path ...        используя CreateProcess. 
    onError         Если onError указан и CreateProcess вернули ошибку
                    переходим к указанной секции
-------------------------------------------------------------------------------
 LogMsg             Логировать все сообщения, кроме указанных в msg.
    msg ...         Также пропускать все сообщения, параметры которых равны
    wParam ...      указанным wParam и lParam. Другими словами аргументы задают
    lParam ...      фильтры.
-------------------------------------------------------------------------------
 RegMsg             Регистрировать сообщения для будущего перехвата с указанием
    handler !       секции обработчика. 0xFFFFFFFF означает любое значение
    msg !           параметра.
    wParam = 0xFFFFFFFF
    lParam = 0xFFFFFFFF
    
-------------------------------------------------------------------------------
 WaitMsg            Запустить перехват сообщений зарегистрированных ранее.
-------------------------------------------------------------------------------
 Input              Симулировать ввод с клавиатуры с помощью keybd_event.
    keyDown ...     Действия выполняются последовательно в том порядке,
    keyUp ...       как они указаны. Действий может быть сколько угодно.
    sleep ...       Значения keyDown и keyUp - 0x0 - 0xFF
                    Значение sleep - время задержки
-------------------------------------------------------------------------------
 Exit               Завершение работы
-------------------------------------------------------------------------------


-------------------------------------------------------------------------------
 3. АРГУМЕНТЫ
-------------------------------------------------------------------------------
 print              Служебный аргумент. Нельзя использовать
-------------------------------------------------------------------------------
 label              Может быть в любой секции. Задает метку секции, по ней
                    можно перейти в секцию используя onError или handler.
-------------------------------------------------------------------------------
 wait = 0           Может быть в любой секции. Задает время ожидания
                    в миллисекундах до перехода к следующей секции.
-------------------------------------------------------------------------------
 stop = no          Может быть в любой секции. Говорит о том, что секция
                    является последней, т.е. остановить выполнение скрипта.
-------------------------------------------------------------------------------
 timeout            Время в миллисекундах
-------------------------------------------------------------------------------
 wnd                Строка с двумя значениями, первое -- это класс окна,
                    второе -- это заголовок окна.
                    Пример: Wnd = LISA_RELOADER; Lisa Reloader
-------------------------------------------------------------------------------
 msg                Любое пользовательское или системное сообщение Windows.
                    Например, WM_CLOSE - 0x10
-------------------------------------------------------------------------------
 wParam             wParam для сообщения
-------------------------------------------------------------------------------
 lParam             lParam для сообщения
-------------------------------------------------------------------------------
 useSend            Флаг для PostWnd
-------------------------------------------------------------------------------
 action             Действие для SetWnd
-------------------------------------------------------------------------------
 flags              Параметр для ShowWindow в секции SetWnd
-------------------------------------------------------------------------------
 check              Проверка для FindWnd
-------------------------------------------------------------------------------
 proc               Имя процесса
-------------------------------------------------------------------------------
 path               Строка с двумя значениями, первое -- это путь до
                    исполняемого файла, второе -- это параметры запуска.
                    Пример: Wnd = \Storage Card\LisaReloader.exe; arg1 arg2
-------------------------------------------------------------------------------
 onError            Метка обработчика ошибок. При возникновении ошибки вместо
                    перехода к следующей секции переходим в указанную.
-------------------------------------------------------------------------------
 handler            Метка обработчика сообщения.
-------------------------------------------------------------------------------
 keyDown            Код клавиши в диапазоне 0x0 - 0xFF
-------------------------------------------------------------------------------
 keyUp              Код клавиши в диапазоне 0x0 - 0xFF
-------------------------------------------------------------------------------
 sleep              Время в миллисекундах
-------------------------------------------------------------------------------
 